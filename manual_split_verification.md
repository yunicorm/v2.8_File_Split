# SettingsWindow分割後 手動検証ガイド

## 🎯 検証目的
分割されたSettingsWindowモジュールが元の機能を完全に保持し、正常に動作することを確認する。

---

## 📋 検証手順

### 準備作業
1. **Main.ahkを実行**してマクロを起動
2. **Path of Exile**または対応ウィンドウをアクティブにする
3. **F6キー**でログビューアを開き、エラー監視を開始

---

## 1. 基本動作テスト ✅

### ウィンドウ表示テスト
- [ ] `Ctrl+Shift+S`キーで設定ウィンドウが表示される
- [ ] ウィンドウサイズが800x600で正しく表示される
- [ ] ウィンドウタイトルが「Path of Exile Macro - 設定」になっている
- [ ] 3つのタブ（フラスコ、スキル、一般）が正しく表示される

**期待結果**: 設定ウィンドウが正常に表示され、分割前と同じレイアウト

### タブ切り替えテスト
- [ ] 「フラスコ」タブをクリックしてフラスコ設定が表示される
- [ ] 「スキル」タブをクリックしてスキル設定が表示される  
- [ ] 「一般」タブをクリックして一般設定が表示される
- [ ] タブ間の切り替えがスムーズに動作する

**期待結果**: 全タブが正常に切り替わり、適切なコンテンツが表示される

### ウィンドウ操作テスト
- [ ] ウィンドウの端をドラッグしてサイズを変更できる
- [ ] 閉じるボタン（×）でウィンドウが正常に閉じる
- [ ] ウィンドウを閉じた後、`g_settings_open`フラグがfalseになる

**期待結果**: 全てのウィンドウ操作が正常に動作する

---

## 2. 設定読み込みテスト ✅

### フラスコタブ読み込み確認
- [ ] Flask1-5の有効状態がConfig.iniと一致
- [ ] フラスコキー設定が正しく表示
- [ ] 間隔Min/Max値が正しく表示
- [ ] フラスコタイプ（Life/Mana等）が正しく選択
- [ ] Tincture設定（リトライ回数、間隔等）が正しく表示

### スキルタブ読み込み確認
- [ ] Group 1スキル（Skill_1_1～1_5）の設定が正しく表示
- [ ] Group 2スキル（Skill_2_1～2_5）の設定が正しく表示
- [ ] スキル名、キー、間隔、優先度が全て正しく表示
- [ ] Wine of the Prophet設定が正しく表示

### 一般タブ読み込み確認
- [ ] システム設定（自動開始、解像度）が正しく表示
- [ ] デバッグ・ログ設定が正しく表示
- [ ] マナ検出設定（座標、閾値等）が正しく表示
- [ ] エリア検出設定（Client.txtパス等）が正しく表示
- [ ] パフォーマンス・UI設定が正しく表示

**期待結果**: 全設定項目がConfig.iniの内容と完全に一致する

---

## 3. 設定保存テスト ✅

### フラスコ設定保存テスト
1. **Flask2の設定を変更**:
   - Enabledチェックボックスを切り替え
   - Keyを「2」から「7」に変更
   - Min間隔を「4500」から「5000」に変更
   - Typeを「Mana」から「Utility」に変更

2. **「保存」ボタンをクリック**

3. **確認作業**:
   - [ ] 保存成功メッセージが表示される
   - [ ] ウィンドウが自動的に閉じる
   - [ ] Config.iniを確認して変更が反映されている
   - [ ] 設定を再度開いて変更が保持されている

### スキル設定保存テスト
1. **Skill_1_1の設定を変更**:
   - Enabledを有効にする
   - Nameを「分割テストスキル」に変更
   - Keyを「q」から「f」に変更
   - Min/Max間隔を「1000/1500」から「2000/2500」に変更
   - 優先度を「3」から「1」に変更

2. **「保存」ボタンをクリック**

3. **確認作業**:
   - [ ] Config.ini [Skill]セクションに変更が反映
   - [ ] 設定再読み込み時に変更が保持

### 一般設定保存テスト
1. **解像度設定を変更**:
   - 画面幅を「3440」から「1920」に変更
   - 画面高さを「1440」から「1080」に変更

2. **マナ設定を変更**:
   - 中心X座標を「1720」から「960」に変更
   - 検出半径を「25」から「30」に変更

3. **「保存」ボタンをクリック**

4. **確認作業**:
   - [ ] Config.ini [Resolution]、[Mana]セクションに変更が反映
   - [ ] 設定再読み込み時に変更が保持

**期待結果**: 全ての変更がConfig.iniに正しく保存され、永続化される

---

## 4. エラーハンドリングテスト ⚠️

### 入力値検証テスト
1. **無効な値の入力**:
   - Flask1のMin間隔に「abc」を入力
   - Skill_1_1のMin間隔に「-100」を入力
   - マナ青閾値に「300」（0-255範囲外）を入力

2. **「保存」ボタンをクリック**

3. **確認項目**:
   - [ ] 適切なエラーダイアログが表示される
   - [ ] エラーメッセージが具体的で理解しやすい
   - [ ] 無効な値は保存されない
   - [ ] ウィンドウは開いたまま（修正可能）

### 重複ウィンドウテスト
1. **設定ウィンドウが開いている状態で`Ctrl+Shift+S`を再度押す**

2. **確認項目**:
   - [ ] 新しいウィンドウが開かない
   - [ ] 既存のウィンドウが前面に表示される
   - [ ] エラーメッセージが表示されない

### 空キー設定テスト
1. **Skill_1_1を有効にしてKeyフィールドを空にする**
2. **「保存」ボタンをクリック**
3. **確認項目**:
   - [ ] 「キーが空です」エラーが表示される

**期待結果**: 全てのエラーケースで適切なエラーハンドリングが動作する

---

## 5. 統合テスト 🔗

### マクロ統合確認
1. **設定変更を保存した後、マクロを再起動**（F12キー）

2. **フラスコ統合確認**:
   - [ ] 変更したフラスコキーで実際にフラスコが動作する
   - [ ] 変更した間隔で動作する
   - [ ] F7デバッグ表示で新しい設定が確認できる

3. **スキル統合確認**:
   - [ ] 有効にしたスキルが実際に動作する
   - [ ] 変更したキーで動作する
   - [ ] 設定した間隔・優先度で動作する

4. **一般設定統合確認**:
   - [ ] F11でマナデバッグ表示して座標変更が反映されている
   - [ ] 解像度変更がシステム全体に反映されている

**期待結果**: 設定変更が実際のマクロ動作に完全に反映される

---

## 🔍 追加確認項目

### ログ確認
- [ ] F6ログビューアでエラーが発生していない
- [ ] 各モジュール（FlaskTab、SkillTab等）からの適切なログ出力
- [ ] 設定保存・読み込み時の正常ログ

### パフォーマンス確認
- [ ] 設定ウィンドウの表示速度が分割前と同等
- [ ] タブ切り替え時の応答性
- [ ] 設定保存時の処理速度

### ファイル確認
- [ ] 全ての分割ファイルが存在
- [ ] UI/SettingsWindow.ahkが正しくインクルードしている
- [ ] バックアップファイル（SettingsWindow_backup.ahk）が存在

---

## ✅ 検証完了チェックリスト

- [ ] **基本動作テスト**: 全て正常
- [ ] **設定読み込みテスト**: 全て正常  
- [ ] **設定保存テスト**: 全て正常
- [ ] **エラーハンドリングテスト**: 全て正常
- [ ] **統合テスト**: 全て正常
- [ ] **ログにエラーなし**: 確認済み
- [ ] **パフォーマンス**: 分割前と同等

---

## 📊 最終判定

**✅ 成功**: 全項目が正常に動作する場合
**⚠️ 要修正**: 一部に問題がある場合  
**❌ 失敗**: 重大な問題がある場合

**検証者**: _______________  
**検証日時**: _______________  
**最終判定**: _______________  
**コメント**: _______________