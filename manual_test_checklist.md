# 設定GUI 手動テストチェックリスト

## テスト実行手順

### 事前準備
1. Main.ahkを実行してマクロを起動
2. Path of Exileまたは対応ウィンドウをアクティブにする

---

## 1. 基本動作テスト

### ✅ ウィンドウ表示テスト
- [ ] `Ctrl+Shift+S`キーで設定ウィンドウが表示される
- [ ] ウィンドウサイズが800x600で表示される
- [ ] ウィンドウタイトルが「Path of Exile Macro - 設定」になっている
- [ ] 3つのタブ（フラスコ、スキル、一般）が表示される

**期待結果**: 設定ウィンドウが正常に表示され、基本レイアウトが正しい

### ✅ タブ切り替えテスト
- [ ] 「フラスコ」タブをクリックしてフラスコ設定が表示される
- [ ] 「スキル」タブをクリックしてスキル設定が表示される
- [ ] 「一般」タブをクリックして一般設定が表示される
- [ ] 各タブ間の切り替えがスムーズに動作する

**期待結果**: 全タブが正常に切り替わり、適切なコンテンツが表示される

### ✅ ウィンドウリサイズテスト
- [ ] ウィンドウの端をドラッグしてサイズを変更できる
- [ ] リサイズ時にコントロールの配置が崩れない
- [ ] 最小サイズ以下に縮小できない

**期待結果**: リサイズが正常に動作し、レイアウトが保持される

---

## 2. 設定の読み込み/保存テスト

### ✅ 設定読み込みテスト
- [ ] フラスコタブでConfig.iniのFlask設定が正しく表示される
- [ ] スキルタブでConfig.iniのSkill設定が正しく表示される
- [ ] 一般タブでConfig.iniのGeneral/Mana設定が正しく表示される
- [ ] チェックボックスの状態が設定ファイルと一致する
- [ ] 数値フィールドの値が設定ファイルと一致する

**期待結果**: 現在のConfig.iniの内容が全て正しくGUIに反映される

### ✅ 設定保存テスト
1. **フラスコ設定の変更**:
   - [ ] Flask1のEnabledチェックボックスを切り替える
   - [ ] Flask1のKeyを変更する（例: "1" → "6"）
   - [ ] Flask1のMin/Max間隔を変更する
   - [ ] 「保存」ボタンをクリック

2. **スキル設定の変更**:
   - [ ] Skill_1_1のEnabledチェックボックスを有効にする
   - [ ] Skill_1_1のNameを変更する（例: "テストスキル"）
   - [ ] Skill_1_1のKeyを設定する（例: "q"）
   - [ ] Skill_1_1のMin/Max間隔を設定する（例: 1000/1500）
   - [ ] 「保存」ボタンをクリック

3. **一般設定の変更**:
   - [ ] DebugModeチェックボックスを切り替える
   - [ ] マナ中心座標を変更する
   - [ ] 「保存」ボタンをクリック

4. **保存後の確認**:
   - [ ] メモ帳でConfig.iniを開いて変更が反映されているか確認
   - [ ] 設定ウィンドウを閉じて再度開き、変更が保持されているか確認

**期待結果**: 変更した設定が全てConfig.iniに正しく保存される

### ✅ キャンセル/リセットテスト
1. **キャンセルテスト**:
   - [ ] 何かの設定を変更する
   - [ ] 「キャンセル」ボタンをクリック
   - [ ] 設定ウィンドウを再度開いて変更が破棄されているか確認

2. **リセットテスト**:
   - [ ] 「リセット」ボタンをクリック
   - [ ] 確認ダイアログで「Yes」を選択
   - [ ] 全設定がデフォルト値に戻っているか確認

**期待結果**: キャンセル時は変更が破棄され、リセット時はデフォルト値に戻る

---

## 3. エラーハンドリングテスト

### ✅ 重複ウィンドウテスト
- [ ] 設定ウィンドウが既に開いている状態で`Ctrl+Shift+S`を再度押す
- [ ] 新しいウィンドウが開かず、既存のウィンドウが前面に表示される
- [ ] エラーメッセージが表示されない

**期待結果**: 重複ウィンドウは開かず、既存ウィンドウが前面表示される

### ✅ 無効なConfig.ini テスト
1. Config.iniを一時的にリネームまたは削除
2. Main.ahkを再起動
3. `Ctrl+Shift+S`で設定ウィンドウを開く
4. [ ] デフォルト値で設定ウィンドウが表示される
5. [ ] エラーなく動作する

**期待結果**: Config.iniが無くてもデフォルト値で正常動作する

---

## 4. 入力値検証テスト

### ✅ 無効な値の入力テスト
1. **文字列を数値フィールドに入力**:
   - [ ] Flask1のMin間隔に「abc」を入力して保存
   - [ ] バリデーションエラーダイアログが表示される
   - [ ] 「空のキー入力で「適用」→エラーハンドリング確認」を確認

2. **範囲外の値を入力**:
   - [ ] マナ青閾値に「300」（0-255範囲外）を入力して保存
   - [ ] バリデーションエラーダイアログが表示される

3. **Min > Max の設定**:
   - [ ] Flask1のMin=5000, Max=3000に設定して保存
   - [ ] バリデーションエラーダイアログが表示される

4. **空のキー設定**:
   - [ ] Skill_1_1を有効にしてKeyフィールドを空にして保存
   - [ ] バリデーションエラーダイアログが表示される

**期待結果**: 無効な値は保存前にバリデーションエラーで検出される

---

## 5. 統合テスト

### ✅ 設定変更の反映テスト
1. **フラスコ設定の反映**:
   - [ ] Flask2を有効にして間隔を変更
   - [ ] 保存後、マクロ実行中にFlask2が設定された間隔で動作するか確認

2. **スキル設定の反映**:
   - [ ] Skill_1_1を有効にして設定
   - [ ] 保存後、マクロ実行中に新しいスキルが動作するか確認

3. **マナ設定の反映**:
   - [ ] マナ検出座標を変更
   - [ ] F11キーでマナデバッグ表示して座標が反映されているか確認

**期待結果**: GUI で変更した設定がマクロの実際の動作に反映される

### ✅ ステータス表示の更新
- [ ] 設定変更後、ステータスオーバーレイ（ScrollLock切り替え）で新しい設定が表示される
- [ ] F7キーのデバッグ表示で変更された設定値が確認できる

**期待結果**: 設定変更がリアルタイムでステータス表示に反映される

---

## 6. ボタン機能テスト（一般タブ）

### ✅ 解像度自動検出
- [ ] 一般タブの「自動検出」ボタンをクリック
- [ ] 現在のモニター解像度が画面幅/高さフィールドに設定される
- [ ] 確認オーバーレイメッセージが表示される

### ✅ ログ管理ボタン
- [ ] 「ログフォルダを開く」ボタンをクリックしてlogsフォルダが開く
- [ ] 「ログをクリア」ボタンをクリックして確認ダイアログが表示される
- [ ] 「Yes」でログファイルが削除される

### ✅ マナ座標取得
- [ ] 「取得」ボタンをクリック
- [ ] 3秒カウントダウン後、マウス座標が取得される
- [ ] 座標値がマナ設定フィールドに反映される

### ✅ Client.txtパス参照
- [ ] 「参照...」ボタンをクリック
- [ ] ファイル選択ダイアログが表示される
- [ ] Client.txtファイルを選択してパスが設定される

**期待結果**: 全ボタンが正常に動作し、対応する機能が実行される

---

## エラーログの確認

テスト中に以下の場所でエラーログを確認してください:

1. **F6キー**: ログビューアでリアルタイムエラー確認
2. **logs\*.log**: ログファイルで詳細エラー情報確認
3. **F7キー**: デバッグ表示で現在の設定状態確認

## テスト完了チェック

- [ ] 全ての基本動作テストが完了
- [ ] 設定の読み込み/保存が正常に動作
- [ ] エラーハンドリングが適切に機能
- [ ] 入力値検証が正しく動作
- [ ] 統合テストで実際のマクロ動作に反映される
- [ ] 重大なエラーやクラッシュが発生しない

## 問題が発生した場合の対処

1. エラーメッセージをスクリーンショットで記録
2. F6でログを確認し、エラー詳細を記録
3. 問題の再現手順を詳しく記録
4. Config.iniのバックアップを取って原因調査

---

**テスト実行者**: _____________  
**テスト日時**: _____________  
**テスト結果**: ✅ 成功 / ❌ 失敗  
**コメント**: ________________________________